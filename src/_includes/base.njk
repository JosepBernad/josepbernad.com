<!DOCTYPE html>
<html lang="{{ urlLang | default('en') }}" {% if sectionName %}data-section{% endif %}>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  {# Determine page path without language prefix for hreflang #}
  {% set pagePath = page.url | replace('/es/', '/') | replace('/ca/', '/') %}
  {% if pagePath == '/es' or pagePath == '/ca' %}{% set pagePath = '/' %}{% endif %}
  
  {# Get SEO data for current page and language #}
  {% set currentLang = urlLang | default('en') %}
  {% set pageKey = pageId | default('home') %}
  {% set seoData = seo[pageKey][currentLang] if seo[pageKey] and seo[pageKey][currentLang] else seo.home.en %}
  
  <!-- SEO Title -->
  <title>{{ seoData.title }}</title>
  
  <!-- Meta Description -->
  <meta name="description" content="{{ seoData.description }}">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://josepbernad.com{{ page.url }}">
  
  <!-- Hreflang Tags for Multilingual SEO -->
  <link rel="alternate" hreflang="en" href="https://josepbernad.com{{ pagePath }}" />
  <link rel="alternate" hreflang="es" href="https://josepbernad.com/es{{ pagePath }}" />
  <link rel="alternate" hreflang="ca" href="https://josepbernad.com/ca{{ pagePath }}" />
  <link rel="alternate" hreflang="x-default" href="https://josepbernad.com{{ pagePath }}" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="{% if pageKey == 'home' %}website{% else %}article{% endif %}">
  <meta property="og:url" content="https://josepbernad.com{{ page.url }}">
  <meta property="og:title" content="{{ seoData.title }}">
  <meta property="og:description" content="{{ seoData.description }}">
  <meta property="og:image" content="https://josepbernad.com/images/og-image.jpg">
  <meta property="og:image:alt" content="Josep Bernad — DJ and Musician from Barcelona and Mallorca">
  <meta property="og:locale" content="{% if currentLang == 'es' %}es_ES{% elif currentLang == 'ca' %}ca_ES{% else %}en_US{% endif %}">
  {% if currentLang != 'en' %}<meta property="og:locale:alternate" content="en_US">{% endif %}
  {% if currentLang != 'es' %}<meta property="og:locale:alternate" content="es_ES">{% endif %}
  {% if currentLang != 'ca' %}<meta property="og:locale:alternate" content="ca_ES">{% endif %}
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://josepbernad.com{{ page.url }}">
  <meta name="twitter:title" content="{{ seoData.title }}">
  <meta name="twitter:description" content="{{ seoData.description }}">
  <meta name="twitter:image" content="https://josepbernad.com/images/og-image.jpg">
  
  <!-- Additional SEO -->
  <meta name="author" content="Josep Bernad">
  <meta name="robots" content="index, follow">
  <meta name="keywords" content="Josep Bernad, DJ, musician, house music, Barcelona, Mallorca, live set, electronic music">
  
  <!-- Favicon -->
  <link rel="icon" id="favicon" href="/favicon-light.svg" type="image/svg+xml">
  
  <!-- Preload background images based on color scheme preference -->
  <link rel="preload" as="image" href="/images/bg-light-mobile.webp" media="(max-width: 767px) and (prefers-color-scheme: light)">
  <link rel="preload" as="image" href="/images/bg-light-desktop.webp" media="(min-width: 768px) and (prefers-color-scheme: light)">
  <link rel="preload" as="image" href="/images/bg-dark-mobile.webp" media="(max-width: 767px) and (prefers-color-scheme: dark)">
  <link rel="preload" as="image" href="/images/bg-dark-desktop.webp" media="(min-width: 768px) and (prefers-color-scheme: dark)">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Sedan:ital@0;1&display=swap">
  <link href="https://fonts.googleapis.com/css2?family=Sedan:ital@0;1&display=swap" rel="stylesheet">
  
  <!-- Styles -->
  <link rel="stylesheet" href="/css/styles.css">

  {% if pageId == 'films' %}
  <!-- Vidstack Player CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vidstack@next/player/styles/base.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vidstack@next/player/styles/default/theme.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vidstack@next/player/styles/default/layouts/video.min.css">
  <!-- Vidstack Player JS (Web Components with layouts) -->
  <script type="module" src="https://cdn.jsdelivr.net/npm/vidstack@next/cdn/with-layouts/vidstack.js"></script>
  {% endif %}
  
  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "WebSite",
        "@id": "https://josepbernad.com/#website",
        "url": "https://josepbernad.com",
        "name": "Josep Bernad",
        "description": "Musician and DJ from Mallorca based in Barcelona",
        "inLanguage": ["en", "es", "ca"]
      },
      {
        "@type": "MusicGroup",
        "@id": "https://josepbernad.com/#musician",
        "name": "Josep Bernad",
        "url": "https://josepbernad.com",
        "logo": "https://josepbernad.com/images/og-image.jpg",
        "image": "https://josepbernad.com/images/about.webp",
        "description": "Musician and DJ from Mallorca based in Barcelona. House music, live sets, and DJ performances.",
        "genre": ["House", "Electronic", "Deep House"],
        "foundingLocation": {
          "@type": "Place",
          "name": "Mallorca, Spain"
        },
        "location": {
          "@type": "Place",
          "name": "Barcelona, Spain"
        },
        "sameAs": [
          "https://www.instagram.com/djosepbernad/",
          "https://www.youtube.com/@JosepBernad",
          "https://open.spotify.com/artist/1f320LpftKzOM47I0RgMfJ",
          "https://soundcloud.com/djosepbernad",
          "https://www.linkedin.com/in/josepbernad/",
          "https://github.com/JosepBernad"
        ],
        "member": {
          "@type": "Person",
          "name": "Josep Bernad",
          "jobTitle": "Musician, DJ",
          "url": "https://josepbernad.com/about/"
        }
      },
      {
        "@type": "SiteNavigationElement",
        "@id": "https://josepbernad.com/#navigation",
        "name": "Main Navigation",
        "hasPart": [
          {
            "@type": "WebPage",
            "name": "Films",
            "description": "Watch live sets and DJ performances by Josep Bernad",
            "url": "https://josepbernad.com/films/"
          },
          {
            "@type": "WebPage",
            "name": "About",
            "description": "Learn about Josep Bernad — musician, DJ, and multi-instrumentalist",
            "url": "https://josepbernad.com/about/"
          },
          {
            "@type": "WebPage",
            "name": "Contact",
            "description": "Get in touch with Josep Bernad for bookings and collaborations",
            "url": "https://josepbernad.com/contact/"
          }
        ]
      }
    ]
  }
  </script>
</head>
<body>
  {% include "header.njk" %}

  <main class="content">
    {{ content | safe }}
  </main>

  {% include "footer.njk" %}

  <script src="/js/main.js"></script>

  <!-- Analytics (GoatCounter - privacy-friendly, no cookies) -->
  <script data-goatcounter="https://josepbernad.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</body>
</html>
